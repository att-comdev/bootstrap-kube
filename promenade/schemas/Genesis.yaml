---
schema: deckhand/DataSchema/v1
metadata:
  schema: metadata/Control/v1
  name: promenade/Genesis/v1
  labels:
    application: promenade
data:
  $schema: http://json-schema.org/schema#
  definitions:
    hostname:
      type: string
      # XXX add regex
    image:
      type: string
      # XXX add regex
    ip_address:
      type: string
      # XXX add regex
    kubernetes_label:
      type: string
      # XXX add regex

  type: object
  properties:
    hostname:
      $ref: '#/definitions/hostname'

    ip:
      $ref: '#/definitions/ip_address'

    labels:
      type: array
      items:
        $ref: '#/definitions/kubernetes_label'

    images:
      type: object
      properties:
        armada:
          $ref: '#/definitions/image'
        helm:
          type: object
          properties:
            helm:
              $ref: '#/definitions/image'
            tiller:
              $ref: '#/definitions/image'
          required:
            - helm
            - tiller
          additionalProperties: false
        kubernetes:
          type: object
          properties:
            apiserver:
              $ref: '#/definitions/image'
            controller-manager:
              $ref: '#/definitions/image'
            etcd:
              $ref: '#/definitions/image'
            kubectl:
              $ref: '#/definitions/image'
            scheduler:
              $ref: '#/definitions/image'
          required:
            - apiserver
            - controller-manager
            - etcd
            - kubectl
            - scheduler
          additionalProperties: false
        promenade:
          $ref: '#/definitions/image'
      required:
        - armada
        - helm
        - kubernetes
        - promenade
      additionalProperties: false

  required:
    - hostname
    - ip
    - images
  additionalProperties: false
...
